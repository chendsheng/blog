(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(k){"use strict";k.registerHelper("fold","brace",function(i,o){var f=o.line,l=i.getLine(f);var e,s;function r(e){for(var r=o.ch,n=0;;){var t=r<=0?-1:l.lastIndexOf(e,r-1);if(t==-1){if(n==1)break;n=1;r=l.length;continue}if(n==1&&t<o.ch)break;s=i.getTokenTypeAt(k.Pos(f,t+1));if(!/^(comment|string)/.test(s))return t+1;r=t-1}}var n="{",t="}",e=r("{");if(e==null){n="[",t="]";e=r("[")}if(e==null)return;var u=1,a=i.lastLine(),d,c;e:for(var g=f;g<=a;++g){var v=i.getLine(g),p=g==f?e:0;for(;;){var m=v.indexOf(n,p),P=v.indexOf(t,p);if(m<0)m=v.length;if(P<0)P=v.length;p=Math.min(m,P);if(p==v.length)break;if(i.getTokenTypeAt(k.Pos(g,p+1))==s){if(p==m)++u;else if(!--u){d=g;c=p;break e}}++p}}if(d==null||f==d&&c==e)return;return{from:k.Pos(f,e),to:k.Pos(d,c)}});k.registerHelper("fold","import",function(f,e){function r(e){if(e<f.firstLine()||e>f.lastLine())return null;var r=f.getTokenAt(k.Pos(e,1));if(!/\S/.test(r.string))r=f.getTokenAt(k.Pos(e,r.end+1));if(r.type!="keyword"||r.string!="import")return null;for(var n=e,t=Math.min(f.lastLine(),e+10);n<=t;++n){var i=f.getLine(n),o=i.indexOf(";");if(o!=-1)return{startCh:r.end,end:k.Pos(n,o)}}}var e=e.line,n=r(e),t;if(!n||r(e-1)||(t=r(e-2))&&t.end.line==e-1)return null;for(var i=n.end;;){var o=r(i.line+1);if(o==null)break;i=o.end}return{from:f.clipPos(k.Pos(e,n.startCh+1)),to:i}});k.registerHelper("fold","include",function(n,e){function r(e){if(e<n.firstLine()||e>n.lastLine())return null;var r=n.getTokenAt(k.Pos(e,1));if(!/\S/.test(r.string))r=n.getTokenAt(k.Pos(e,r.end+1));if(r.type=="meta"&&r.string.slice(0,8)=="#include")return r.start+8}var e=e.line,t=r(e);if(t==null||r(e-1)!=null)return null;for(var i=e;;){var o=r(i+1);if(o==null)break;++i}return{from:k.Pos(e,t+1),to:n.clipPos(k.Pos(i))}})});