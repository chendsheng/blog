(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("vb",function(t,a){var u="error";function e(e){return new RegExp("^(("+e.join(")|(")+"))\\b","i")}var o=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var f=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var c=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var l=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var d=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var s=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var r=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var n=["else","elseif","case","catch"];var i=["next","loop"];var v=e(["and","or","not","xor","in"]);var m=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var h=["integer","string","double","decimal","boolean","short","char","float","single"];var p=e(m);var b=e(h);var k='"';var x=e(r);var g=e(n);var w=e(i);var y=e(["end"]);var I=e(["do"]);var E=null;function L(e,r){r.currentIndent++}function z(e,r){r.currentIndent--}function C(e,r){if(e.eatSpace()){return null}var n=e.peek();if(n==="'"){e.skipToEnd();return"comment"}if(e.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var t=false;if(e.match(/^\d*\.\d+F?/i)){t=true}else if(e.match(/^\d+\.\d*F?/)){t=true}else if(e.match(/^\.\d+F?/)){t=true}if(t){e.eat(/J/i);return"number"}var i=false;if(e.match(/^&H[0-9a-f]+/i)){i=true}else if(e.match(/^&O[0-7]+/i)){i=true}else if(e.match(/^[1-9]\d*F?/)){e.eat(/J/i);i=true}else if(e.match(/^0(?![\dx])/i)){i=true}if(i){e.eat(/L/i);return"number"}}if(e.match(k)){r.tokenize=R(e.current());return r.tokenize(e,r)}if(e.match(d)||e.match(l)){return null}if(e.match(c)||e.match(o)||e.match(v)){return"operator"}if(e.match(f)){return null}if(e.match(I)){L(e,r);r.doInCurrentLine=true;return"keyword"}if(e.match(x)){if(!r.doInCurrentLine)L(e,r);else r.doInCurrentLine=false;return"keyword"}if(e.match(g)){return"keyword"}if(e.match(y)){z(e,r);z(e,r);return"keyword"}if(e.match(w)){z(e,r);return"keyword"}if(e.match(b)){return"keyword"}if(e.match(p)){return"keyword"}if(e.match(s)){return"variable"}e.next();return u}function R(n){var t=n.length==1;var i="string";return function(e,r){while(!e.eol()){e.eatWhile(/[^'"]/);if(e.match(n)){r.tokenize=C;return i}else{e.eat(/['"]/)}}if(t){if(a.singleLineStringErrors){return u}else{r.tokenize=C}}return i}}function F(e,r){var n=r.tokenize(e,r);var t=e.current();if(t==="."){n=r.tokenize(e,r);t=e.current();if(n==="variable"){return"variable"}else{return u}}var i="[({".indexOf(t);if(i!==-1){L(e,r)}if(E==="dedent"){if(z(e,r)){return u}}i="])}".indexOf(t);if(i!==-1){if(z(e,r)){return u}}return n}var M={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:C,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(e,r){if(e.sol()){r.currentIndent+=r.nextLineIndent;r.nextLineIndent=0;r.doInCurrentLine=0}var n=F(e,r);r.lastToken={style:n,content:e.current()};return n},indent:function(e,r){var n=r.replace(/^\s+|\s+$/g,"");if(n.match(w)||n.match(y)||n.match(g))return t.indentUnit*(e.currentIndent-1);if(e.currentIndent<0)return 0;return e.currentIndent*t.indentUnit}};return M});e.defineMIME("text/x-vb","vb")});