(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(t){"use strict";t.defineMode("ebnf",function(e){var s={slash:0,parenthesis:1};var i={comment:0,_string:1,characterClass:2};var l=null;if(e.bracesMode)l=t.getMode(e,e.bracesMode);return{startState:function(){return{stringType:null,commentType:null,braced:0,lhs:true,localState:null,stack:[],inDefinition:false}},token:function(e,t){if(!e)return;if(t.stack.length===0){if(e.peek()=='"'||e.peek()=="'"){t.stringType=e.peek();e.next();t.stack.unshift(i._string)}else if(e.match(/^\/\*/)){t.stack.unshift(i.comment);t.commentType=s.slash}else if(e.match(/^\(\*/)){t.stack.unshift(i.comment);t.commentType=s.parenthesis}}switch(t.stack[0]){case i._string:while(t.stack[0]===i._string&&!e.eol()){if(e.peek()===t.stringType){e.next();t.stack.shift()}else if(e.peek()==="\\"){e.next();e.next()}else{e.match(/^.[^\\\"\']*/)}}return t.lhs?"property string":"string";case i.comment:while(t.stack[0]===i.comment&&!e.eol()){if(t.commentType===s.slash&&e.match(/\*\//)){t.stack.shift();t.commentType=null}else if(t.commentType===s.parenthesis&&e.match(/\*\)/)){t.stack.shift();t.commentType=null}else{e.match(/^.[^\*]*/)}}return"comment";case i.characterClass:while(t.stack[0]===i.characterClass&&!e.eol()){if(!(e.match(/^[^\]\\]+/)||e.match(/^\\./))){t.stack.shift()}}return"operator"}var a=e.peek();if(l!==null&&(t.braced||a==="{")){if(t.localState===null)t.localState=l.startState();var r=l.token(e,t.localState),c=e.current();if(!r){for(var n=0;n<c.length;n++){if(c[n]==="{"){if(t.braced===0){r="matchingbracket"}t.braced++}else if(c[n]==="}"){t.braced--;if(t.braced===0){r="matchingbracket"}}}}return r}switch(a){case"[":e.next();t.stack.unshift(i.characterClass);return"bracket";case":":case"|":case";":e.next();return"operator";case"%":if(e.match("%%")){return"header"}else if(e.match(/[%][A-Za-z]+/)){return"keyword"}else if(e.match(/[%][}]/)){return"matchingbracket"}break;case"/":if(e.match(/[\/][A-Za-z]+/)){return"keyword"}case"\\":if(e.match(/[\][a-z]+/)){return"string-2"}case".":if(e.match(".")){return"atom"}case"*":case"-":case"+":case"^":if(e.match(a)){return"atom"}case"$":if(e.match("$$")){return"builtin"}else if(e.match(/[$][0-9]+/)){return"variable-3"}case"<":if(e.match(/<<[a-zA-Z_]+>>/)){return"builtin"}}if(e.match(/^\/\//)){e.skipToEnd();return"comment"}else if(e.match(/return/)){return"operator"}else if(e.match(/^[a-zA-Z_][a-zA-Z0-9_]*/)){if(e.match(/(?=[\(.])/)){return"variable"}else if(e.match(/(?=[\s\n]*[:=])/)){return"def"}return"variable-2"}else if(["[","]","(",")"].indexOf(e.peek())!=-1){e.next();return"bracket"}else if(!e.eatSpace()){e.next()}return null}}});t.defineMIME("text/x-ebnf","ebnf")});