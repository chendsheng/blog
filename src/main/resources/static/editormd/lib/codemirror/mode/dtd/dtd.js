(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("dtd",function(e){var r=e.indentUnit,i;function l(e,t){i=t;return e}function s(e,t){var n=e.next();if(n=="<"&&e.eat("!")){if(e.eatWhile(/[\-]/)){t.tokenize=u;return u(e,t)}else if(e.eatWhile(/[\w]/))return l("keyword","doindent")}else if(n=="<"&&e.eat("?")){t.tokenize=f("meta","?>");return l("meta",n)}else if(n=="#"&&e.eatWhile(/[\w]/))return l("atom","tag");else if(n=="|")return l("keyword","seperator");else if(n.match(/[\(\)\[\]\-\.,\+\?>]/))return l(null,n);else if(n.match(/[\[\]]/))return l("rule",n);else if(n=='"'||n=="'"){t.tokenize=a(n);return t.tokenize(e,t)}else if(e.eatWhile(/[a-zA-Z\?\+\d]/)){var r=e.current();if(r.substr(r.length-1,r.length).match(/\?|\+/)!==null)e.backUp(1);return l("tag","tag")}else if(n=="%"||n=="*")return l("number","number");else{e.eatWhile(/[\w\\\-_%.{,]/);return l(null,null)}}function u(e,t){var n=0,r;while((r=e.next())!=null){if(n>=2&&r==">"){t.tokenize=s;break}n=r=="-"?n+1:0}return l("comment","comment")}function a(i){return function(e,t){var n=false,r;while((r=e.next())!=null){if(r==i&&!n){t.tokenize=s;break}n=!n&&r=="\\"}return l("string","tag")}}function f(n,r){return function(e,t){while(!e.eol()){if(e.match(r)){t.tokenize=s;break}e.next()}return n}}return{startState:function(e){return{tokenize:s,baseIndent:e||0,stack:[]}},token:function(e,t){if(e.eatSpace())return null;var n=t.tokenize(e,t);var r=t.stack[t.stack.length-1];if(e.current()=="["||i==="doindent"||i=="[")t.stack.push("rule");else if(i==="endtag")t.stack[t.stack.length-1]="endtag";else if(e.current()=="]"||i=="]"||i==">"&&r=="rule")t.stack.pop();else if(i=="[")t.stack.push("[");return n},indent:function(e,t){var n=e.stack.length;if(t.match(/\]\s+|\]/))n=n-1;else if(t.substr(t.length-1,t.length)===">"){if(t.substr(0,1)==="<")n;else if(i=="doindent"&&t.length>1)n;else if(i=="doindent")n--;else if(i==">"&&t.length>1)n;else if(i=="tag"&&t!==">")n;else if(i=="tag"&&e.stack[e.stack.length-1]=="rule")n--;else if(i=="tag")n++;else if(t===">"&&e.stack[e.stack.length-1]=="rule"&&i===">")n--;else if(t===">"&&e.stack[e.stack.length-1]=="rule")n;else if(t.substr(0,1)!=="<"&&t.substr(0,1)===">")n=n-1;else if(t===">")n;else n=n-1;if(i==null||i=="]")n--}return e.baseIndent+n*r},electricChars:"]>"}});e.defineMIME("application/xml-dtd","dtd")});