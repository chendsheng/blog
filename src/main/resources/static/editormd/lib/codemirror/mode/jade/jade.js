(function(t){if(typeof exports=="object"&&typeof module=="object")t(require("../../lib/codemirror"),require("../javascript/javascript"),require("../css/css"),require("../htmlmixed/htmlmixed"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../javascript/javascript","../css/css","../htmlmixed/htmlmixed"],t);else t(CodeMirror)})(function(X){"use strict";X.defineMode("jade",function(n){var i="keyword";var e="meta";var r="builtin";var a="qualifier";var s={"{":"}","(":")","[":"]"};var u=X.getMode(n,"javascript");function c(){this.javaScriptLine=false;this.javaScriptLineExcludesColon=false;this.javaScriptArguments=false;this.javaScriptArgumentsDepth=0;this.isInterpolating=false;this.interpolationNesting=0;this.jsState=u.startState();this.restOfLine="";this.isIncludeFiltered=false;this.isEach=false;this.lastTag="";this.scriptType="";this.isAttrs=false;this.attrsNest=[];this.inAttributeName=true;this.attributeIsType=false;this.attrValue="";this.indentOf=Infinity;this.indentToken="";this.innerMode=null;this.innerState=null;this.innerModeForLine=false}c.prototype.copy=function(){var t=new c;t.javaScriptLine=this.javaScriptLine;t.javaScriptLineExcludesColon=this.javaScriptLineExcludesColon;t.javaScriptArguments=this.javaScriptArguments;t.javaScriptArgumentsDepth=this.javaScriptArgumentsDepth;t.isInterpolating=this.isInterpolating;t.interpolationNesting=this.intpolationNesting;t.jsState=X.copyState(u,this.jsState);t.innerMode=this.innerMode;if(this.innerMode&&this.innerState){t.innerState=X.copyState(this.innerMode,this.innerState)}t.restOfLine=this.restOfLine;t.isIncludeFiltered=this.isIncludeFiltered;t.isEach=this.isEach;t.lastTag=this.lastTag;t.scriptType=this.scriptType;t.isAttrs=this.isAttrs;t.attrsNest=this.attrsNest.slice();t.inAttributeName=this.inAttributeName;t.attributeIsType=this.attributeIsType;t.attrValue=this.attrValue;t.indentOf=this.indentOf;t.indentToken=this.indentToken;t.innerModeForLine=this.innerModeForLine;return t};function f(t,e){if(t.sol()){e.javaScriptLine=false;e.javaScriptLineExcludesColon=false}if(e.javaScriptLine){if(e.javaScriptLineExcludesColon&&t.peek()===":"){e.javaScriptLine=false;e.javaScriptLineExcludesColon=false;return}var i=u.token(t,e.jsState);if(t.eol())e.javaScriptLine=false;return i||true}}function o(t,e){if(e.javaScriptArguments){if(e.javaScriptArgumentsDepth===0&&t.peek()!=="("){e.javaScriptArguments=false;return}if(t.peek()==="("){e.javaScriptArgumentsDepth++}else if(t.peek()===")"){e.javaScriptArgumentsDepth--}if(e.javaScriptArgumentsDepth===0){e.javaScriptArguments=false;return}var i=u.token(t,e.jsState);return i||true}}function l(t){if(t.match(/^yield\b/)){return"keyword"}}function p(t){if(t.match(/^(?:doctype) *([^\n]+)?/)){return e}}function h(t,e){if(t.match("#{")){e.isInterpolating=true;e.interpolationNesting=0;return"punctuation"}}function d(t,e){if(e.isInterpolating){if(t.peek()==="}"){e.interpolationNesting--;if(e.interpolationNesting<0){t.next();e.isInterpolating=false;return"puncutation"}}else if(t.peek()==="{"){e.interpolationNesting++}return u.token(t,e.jsState)||true}}function m(t,e){if(t.match(/^case\b/)){e.javaScriptLine=true;return i}}function v(t,e){if(t.match(/^when\b/)){e.javaScriptLine=true;e.javaScriptLineExcludesColon=true;return i}}function S(t){if(t.match(/^default\b/)){return i}}function j(t,e){if(t.match(/^extends?\b/)){e.restOfLine="string";return i}}function g(t,e){if(t.match(/^append\b/)){e.restOfLine="variable";return i}}function b(t,e){if(t.match(/^prepend\b/)){e.restOfLine="variable";return i}}function L(t,e){if(t.match(/^block\b *(?:(prepend|append)\b)?/)){e.restOfLine="variable";return i}}function A(t,e){if(t.match(/^include\b/)){e.restOfLine="string";return i}}function y(t,e){if(t.match(/^include:([a-zA-Z0-9\-]+)/,false)&&t.match("include")){e.isIncludeFiltered=true;return i}}function k(t,e){if(e.isIncludeFiltered){var i=C(t,e);e.isIncludeFiltered=false;e.restOfLine="string";return i}}function T(t,e){if(t.match(/^mixin\b/)){e.javaScriptLine=true;return i}}function M(t,e){if(t.match(/^\+([-\w]+)/)){if(!t.match(/^\( *[-\w]+ *=/,false)){e.javaScriptArguments=true;e.javaScriptArgumentsDepth=0}return"variable"}if(t.match(/^\+#{/,false)){t.next();e.mixinCallAfter=true;return h(t,e)}}function x(t,e){if(e.mixinCallAfter){e.mixinCallAfter=false;if(!t.match(/^\( *[-\w]+ *=/,false)){e.javaScriptArguments=true;e.javaScriptArgumentsDepth=0}return true}}function N(t,e){if(t.match(/^(if|unless|else if|else)\b/)){e.javaScriptLine=true;return i}}function w(t,e){if(t.match(/^(- *)?(each|for)\b/)){e.isEach=true;return i}}function I(t,e){if(e.isEach){if(t.match(/^ in\b/)){e.javaScriptLine=true;e.isEach=false;return i}else if(t.sol()||t.eol()){e.isEach=false}else if(t.next()){while(!t.match(/^ in\b/,false)&&t.next());return"variable"}}}function O(t,e){if(t.match(/^while\b/)){e.javaScriptLine=true;return i}}function E(t,e){var i;if(i=t.match(/^(\w(?:[-:\w]*\w)?)\/?/)){e.lastTag=i[1].toLowerCase();if(e.lastTag==="script"){e.scriptType="application/javascript"}return"tag"}}function C(t,e){if(t.match(/^:([\w\-]+)/)){var i;if(n&&n.innerModes){i=n.innerModes(t.current().substring(1))}if(!i){i=t.current().substring(1)}if(typeof i==="string"){i=X.getMode(n,i)}D(t,e,i);return"atom"}}function q(t,e){if(t.match(/^(!?=|-)/)){e.javaScriptLine=true;return"punctuation"}}function z(t){if(t.match(/^#([\w-]+)/)){return r}}function U(t){if(t.match(/^\.([\w-]+)/)){return a}}function Z(t,e){if(t.peek()=="("){t.next();e.isAttrs=true;e.attrsNest=[];e.inAttributeName=true;e.attrValue="";e.attributeIsType=false;return"punctuation"}}function F(t,e){if(e.isAttrs){if(s[t.peek()]){e.attrsNest.push(s[t.peek()])}if(e.attrsNest[e.attrsNest.length-1]===t.peek()){e.attrsNest.pop()}else if(t.eat(")")){e.isAttrs=false;return"punctuation"}if(e.inAttributeName&&t.match(/^[^=,\)!]+/)){if(t.peek()==="="||t.peek()==="!"){e.inAttributeName=false;e.jsState=u.startState();if(e.lastTag==="script"&&t.current().trim().toLowerCase()==="type"){e.attributeIsType=true}else{e.attributeIsType=false}}return"attribute"}var i=u.token(t,e.jsState);if(e.attributeIsType&&i==="string"){e.scriptType=t.current().toString()}if(e.attrsNest.length===0&&(i==="string"||i==="variable"||i==="keyword")){try{Function("","var x "+e.attrValue.replace(/,\s*$/,"").replace(/^!/,""));e.inAttributeName=true;e.attrValue="";t.backUp(t.current().length);return F(t,e)}catch(t){}}e.attrValue+=t.current();return i||true}}function $(t,e){if(t.match(/^&attributes\b/)){e.javaScriptArguments=true;e.javaScriptArgumentsDepth=0;return"keyword"}}function B(t){if(t.sol()&&t.eatSpace()){return"indent"}}function G(t,e){if(t.match(/^ *\/\/(-)?([^\n]*)/)){e.indentOf=t.indentation();e.indentToken="comment";return"comment"}}function H(t){if(t.match(/^: */)){return"colon"}}function J(t,e){if(t.match(/^(?:\| ?| )([^\n]+)/)){return"string"}if(t.match(/^(<[^\n]*)/,false)){D(t,e,"htmlmixed");e.innerModeForLine=true;return V(t,e,true)}}function K(t,e){if(t.eat(".")){var i=null;if(e.lastTag==="script"&&e.scriptType.toLowerCase().indexOf("javascript")!=-1){i=e.scriptType.toLowerCase().replace(/"|'/g,"")}else if(e.lastTag==="style"){i="css"}D(t,e,i);return"dot"}}function P(t){t.next();return null}function D(t,e,i){i=X.mimeModes[i]||i;i=n.innerModes?n.innerModes(i)||i:i;i=X.mimeModes[i]||i;i=X.getMode(n,i);e.indentOf=t.indentation();if(i&&i.name!=="null"){e.innerMode=i}else{e.indentToken="string"}}function V(t,e,i){if(t.indentation()>e.indentOf||e.innerModeForLine&&!t.sol()||i){if(e.innerMode){if(!e.innerState){e.innerState=e.innerMode.startState?e.innerMode.startState(t.indentation()):{}}return t.hideFirstChars(e.indentOf+2,function(){return e.innerMode.token(t,e.innerState)||true})}else{t.skipToEnd();return e.indentToken}}else if(t.sol()){e.indentOf=Infinity;e.indentToken=null;e.innerMode=null;e.innerState=null}}function Q(t,e){if(t.sol()){e.restOfLine=""}if(e.restOfLine){t.skipToEnd();var i=e.restOfLine;e.restOfLine="";return i}}function t(){return new c}function R(t){return t.copy()}function W(t,e){var i=V(t,e)||Q(t,e)||d(t,e)||k(t,e)||I(t,e)||F(t,e)||f(t,e)||o(t,e)||x(t,e)||l(t,e)||p(t,e)||h(t,e)||m(t,e)||v(t,e)||S(t,e)||j(t,e)||g(t,e)||b(t,e)||L(t,e)||A(t,e)||y(t,e)||T(t,e)||M(t,e)||N(t,e)||w(t,e)||O(t,e)||E(t,e)||C(t,e)||q(t,e)||z(t,e)||U(t,e)||Z(t,e)||$(t,e)||B(t,e)||J(t,e)||G(t,e)||H(t,e)||K(t,e)||P(t,e);return i===true?null:i}return{startState:t,copyState:R,token:W}});X.defineMIME("text/x-jade","jade")});