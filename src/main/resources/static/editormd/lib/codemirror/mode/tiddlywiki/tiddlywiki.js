(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("tiddlywiki",function(){var o={};var a=function(){function e(e){return{type:e,style:"macro"}}return{allTags:e("allTags"),closeAll:e("closeAll"),list:e("list"),newJournal:e("newJournal"),newTiddler:e("newTiddler"),permaview:e("permaview"),saveChanges:e("saveChanges"),search:e("search"),slider:e("slider"),tabs:e("tabs"),tag:e("tag"),tagging:e("tagging"),tags:e("tags"),tiddler:e("tiddler"),timeline:e("timeline"),today:e("today"),version:e("version"),option:e("option"),with:e("with"),filter:e("filter")}}();var u=/[\w_\-]/i,f=/^\-\-\-\-+$/,l=/^\/\*\*\*$/,c=/^\*\*\*\/$/,s=/^<<<$/,m=/^\/\/\{\{\{$/,d=/^\/\/\}\}\}$/,h=/^<!--\{\{\{-->$/,k=/^<!--\}\}\}-->$/,b=/^\{\{\{$/,i=/^\}\}\}$/,p=/.*?\}\}\}/;function v(e,t,r){t.tokenize=r;return r(e,t)}var n,x;function w(e,t,r){n=e;x=r;return t}function g(e,t){var r=e.sol(),n;t.block=false;n=e.peek();if(r&&/[<\/\*{}\-]/.test(n)){if(e.match(b)){t.block=true;return v(e,t,z)}if(e.match(s)){return w("quote","quote")}if(e.match(l)||e.match(c)){return w("code","comment")}if(e.match(m)||e.match(d)||e.match(h)||e.match(k)){return w("code","comment")}if(e.match(f)){return w("hr","hr")}}n=e.next();if(r&&/[\/\*!#;:>|]/.test(n)){if(n=="!"){e.skipToEnd();return w("header","header")}if(n=="*"){e.eatWhile("*");return w("list","comment")}if(n=="#"){e.eatWhile("#");return w("list","comment")}if(n==";"){e.eatWhile(";");return w("list","comment")}if(n==":"){e.eatWhile(":");return w("list","comment")}if(n==">"){e.eatWhile(">");return w("quote","quote")}if(n=="|"){return w("table","header")}}if(n=="{"&&e.match(/\{\{/)){return v(e,t,z)}if(/[hf]/i.test(n)){if(/[ti]/i.test(e.peek())&&e.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return w("link","link")}}if(n=='"'){return w("string","string")}if(n=="~"){return w("text","brace")}if(/[\[\]]/.test(n)){if(e.peek()==n){e.next();return w("brace","brace")}}if(n=="@"){e.eatWhile(u);return w("link","link")}if(/\d/.test(n)){e.eatWhile(/\d/);return w("number","number")}if(n=="/"){if(e.eat("%")){return v(e,t,y)}else if(e.eat("/")){return v(e,t,W)}}if(n=="_"){if(e.eat("_")){return v(e,t,_)}}if(n=="-"){if(e.eat("-")){if(e.peek()!=" ")return v(e,t,q);if(e.peek()==" ")return w("text","brace")}}if(n=="'"){if(e.eat("'")){return v(e,t,$)}}if(n=="<"){if(e.eat("<")){return v(e,t,T)}}else{return w(n)}e.eatWhile(/[\w\$_]/);var i=e.current(),a=o.propertyIsEnumerable(i)&&o[i];return a?w(a.type,a.style,i):w("text",null,i)}function y(e,t){var r=false,n;while(n=e.next()){if(n=="/"&&r){t.tokenize=g;break}r=n=="%"}return w("comment","comment")}function $(e,t){var r=false,n;while(n=e.next()){if(n=="'"&&r){t.tokenize=g;break}r=n=="'"}return w("text","strong")}function z(e,t){var r,n=t.block;if(n&&e.current()){return w("code","comment")}if(!n&&e.match(p)){t.tokenize=g;return w("code","comment")}if(n&&e.sol()&&e.match(i)){t.tokenize=g;return w("code","comment")}r=e.next();return n?w("code","comment"):w("code","comment")}function W(e,t){var r=false,n;while(n=e.next()){if(n=="/"&&r){t.tokenize=g;break}r=n=="/"}return w("text","em")}function _(e,t){var r=false,n;while(n=e.next()){if(n=="_"&&r){t.tokenize=g;break}r=n=="_"}return w("text","underlined")}function q(e,t){var r=false,n;while(n=e.next()){if(n=="-"&&r){t.tokenize=g;break}r=n=="-"}return w("text","strikethrough")}function T(e,t){var r,n,i;if(e.current()=="<<"){return w("brace","macro")}r=e.next();if(!r){t.tokenize=g;return w(r)}if(r==">"){if(e.peek()==">"){e.next();t.tokenize=g;return w("brace","macro")}}e.eatWhile(/[\w\$_]/);n=e.current();i=a.propertyIsEnumerable(n)&&a[n];if(i){return w(i.type,i.style,n)}else{return w("macro",null,n)}}return{startState:function(){return{tokenize:g,indented:0,level:0}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r},electricChars:""}});e.defineMIME("text/x-tiddlywiki","tiddlywiki")});