(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("smarty",function(e){"use strict";var l={rightDelimiter:"}",leftDelimiter:"{",smartyVersion:2};if(e.hasOwnProperty("leftDelimiter")){l.leftDelimiter=e.leftDelimiter}if(e.hasOwnProperty("rightDelimiter")){l.rightDelimiter=e.rightDelimiter}if(e.hasOwnProperty("smartyVersion")&&e.smartyVersion===3){l.smartyVersion=3}var f=["debug","extends","function","include","literal"];var s;var u={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};var c={cont:function(e,t){s=t;return e},chain:function(e,t,r){t.tokenize=r;return r(e,t)}};var d={tokenizer:function(e,t){if(e.match(l.leftDelimiter,true)){if(e.eat("*")){return c.chain(e,t,d.inBlock("comment","*"+l.rightDelimiter))}else{t.depth++;var r=e.eol();var i=/\s/.test(e.peek());if(l.smartyVersion===3&&l.leftDelimiter==="{"&&(r||i)){t.depth--;return null}else{t.tokenize=d.smarty;s="startTag";return"tag"}}}else{e.next();return null}},smarty:function(e,t){if(e.match(l.rightDelimiter,true)){if(l.smartyVersion===3){t.depth--;if(t.depth<=0){t.tokenize=d.tokenizer}}else{t.tokenize=d.tokenizer}return c.cont("tag",null)}if(e.match(l.leftDelimiter,true)){t.depth++;return c.cont("tag","startTag")}var r=e.next();if(r=="$"){e.eatWhile(u.validIdentifier);return c.cont("variable-2","variable")}else if(r=="|"){return c.cont("operator","pipe")}else if(r=="."){return c.cont("operator","property")}else if(u.stringChar.test(r)){t.tokenize=d.inAttribute(r);return c.cont("string","string")}else if(u.operatorChars.test(r)){e.eatWhile(u.operatorChars);return c.cont("operator","operator")}else if(r=="["||r=="]"){return c.cont("bracket","bracket")}else if(r=="("||r==")"){return c.cont("bracket","operator")}else if(/\d/.test(r)){e.eatWhile(/\d/);return c.cont("number","number")}else{if(t.last=="variable"){if(r=="@"){e.eatWhile(u.validIdentifier);return c.cont("property","property")}else if(r=="|"){e.eatWhile(u.validIdentifier);return c.cont("qualifier","modifier")}}else if(t.last=="pipe"){e.eatWhile(u.validIdentifier);return c.cont("qualifier","modifier")}else if(t.last=="whitespace"){e.eatWhile(u.validIdentifier);return c.cont("attribute","modifier")}if(t.last=="property"){e.eatWhile(u.validIdentifier);return c.cont("property",null)}else if(/\s/.test(r)){s="whitespace";return null}var i="";if(r!="/"){i+=r}var n=null;while(n=e.eat(u.validIdentifier)){i+=n}for(var a=0,o=f.length;a<o;a++){if(f[a]==i){return c.cont("keyword","keyword")}}if(/\s/.test(r)){return null}return c.cont("tag","tag")}},inAttribute:function(n){return function(e,t){var r=null;var i=null;while(!e.eol()){i=e.peek();if(e.next()==n&&r!=="\\"){t.tokenize=d.smarty;break}r=i}return"string"}},inBlock:function(r,i){return function(e,t){while(!e.eol()){if(e.match(i)){t.tokenize=d.tokenizer;break}e.next()}return r}}};return{startState:function(){return{tokenize:d.tokenizer,mode:"smarty",last:null,depth:0}},token:function(e,t){var r=t.tokenize(e,t);t.last=s;return r},electricChars:""}});e.defineMIME("text/x-smarty","smarty")});