(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("coffeescript",function(a,f){var c="error";function e(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var s=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var l=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var u=/^[_A-Za-z$][_A-Za-z$0-9]*/;var p=/^(@|this\.)[_A-Za-z$][_A-Za-z$0-9]*/;var d=e(["and","or","not","is","isnt","in","instanceof","typeof"]);var o=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var t=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var v=e(o.concat(t));o=e(o);var m=/^('{3}|\"{3}|['\"])/;var h=/^(\/{3}|\/)/;var r=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var k=e(r);function y(e,t){if(e.sol()){if(t.scope.align===null)t.scope.align=false;var r=t.scope.offset;if(e.eatSpace()){var n=e.indentation();if(n>r&&t.scope.type=="coffee"){return"indent"}else if(n<r){return"dedent"}return null}else{if(r>0){w(e,t)}}}if(e.eatSpace()){return null}var i=e.peek();if(e.match("####")){e.skipToEnd();return"comment"}if(e.match("###")){t.tokenize=g;return t.tokenize(e,t)}if(i==="#"){e.skipToEnd();return"comment"}if(e.match(/^-?[0-9\.]/,false)){var f=false;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){f=true}if(e.match(/^-?\d+\.\d*/)){f=true}if(e.match(/^-?\.\d+/)){f=true}if(f){if(e.peek()=="."){e.backUp(1)}return"number"}var o=false;if(e.match(/^-?0x[0-9a-f]+/i)){o=true}if(e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){o=true}if(e.match(/^-?0(?![\dx])/i)){o=true}if(o){return"number"}}if(e.match(m)){t.tokenize=b(e.current(),false,"string");return t.tokenize(e,t)}if(e.match(h)){if(e.current()!="/"||e.match(/^.*\//,false)){t.tokenize=b(e.current(),true,"string-2");return t.tokenize(e,t)}else{e.backUp(1)}}if(e.match(s)||e.match(d)){return"operator"}if(e.match(l)){return"punctuation"}if(e.match(k)){return"atom"}if(e.match(v)){return"keyword"}if(e.match(u)){return"variable"}if(e.match(p)){return"property"}e.next();return c}function b(r,n,i){return function(e,t){while(!e.eol()){e.eatWhile(/[^'"\/\\]/);if(e.eat("\\")){e.next();if(n&&e.eol()){return i}}else if(e.match(r)){t.tokenize=y;return i}else{e.eat(/['"\/]/)}}if(n){if(f.singleLineStringErrors){i=c}else{t.tokenize=y}}return i}}function g(e,t){while(!e.eol()){e.eatWhile(/[^#]/);if(e.match("###")){t.tokenize=y;break}e.eatWhile("#")}return"comment"}function z(e,t,r){r=r||"coffee";var n=0,i=false,f=null;for(var o=t.scope;o;o=o.prev){if(o.type==="coffee"||o.type=="}"){n=o.offset+a.indentUnit;break}}if(r!=="coffee"){i=null;f=e.column()+e.current().length}else if(t.scope.align){t.scope.align=false}t.scope={offset:n,type:r,prev:t.scope,align:i,alignOffset:f}}function w(e,t){if(!t.scope.prev)return;if(t.scope.type==="coffee"){var r=e.indentation();var n=false;for(var i=t.scope;i;i=i.prev){if(r===i.offset){n=true;break}}if(!n){return true}while(t.scope.prev&&t.scope.offset!==r){t.scope=t.scope.prev}return false}else{t.scope=t.scope.prev;return false}}function i(e,t){var r=t.tokenize(e,t);var n=e.current();if(n==="."){r=t.tokenize(e,t);n=e.current();if(/^\.[\w$]+$/.test(n)){return"variable"}else{return c}}if(n==="return"){t.dedent=true}if((n==="->"||n==="=>")&&!t.lambda&&!e.peek()||r==="indent"){z(e,t)}var i="[({".indexOf(n);if(i!==-1){z(e,t,"])}".slice(i,i+1))}if(o.exec(n)){z(e,t)}if(n=="then"){w(e,t)}if(r==="dedent"){if(w(e,t)){return c}}i="])}".indexOf(n);if(i!==-1){while(t.scope.type=="coffee"&&t.scope.prev)t.scope=t.scope.prev;if(t.scope.type==n)t.scope=t.scope.prev}if(t.dedent&&e.eol()){if(t.scope.type=="coffee"&&t.scope.prev)t.scope=t.scope.prev;t.dedent=false}return r}var n={startState:function(e){return{tokenize:y,scope:{offset:e||0,type:"coffee",prev:null,align:false},lastToken:null,lambda:false,dedent:0}},token:function(e,t){var r=t.scope.align===null&&t.scope;if(r&&e.sol())r.align=false;var n=i(e,t);if(r&&n&&n!="comment")r.align=true;t.lastToken={style:n,content:e.current()};if(e.eol()&&e.lambda){t.lambda=false}return n},indent:function(e,t){if(e.tokenize!=y)return 0;var r=e.scope;var n=t&&"])}".indexOf(t.charAt(0))>-1;if(n)while(r.type=="coffee"&&r.prev)r=r.prev;var i=n&&r.type===t.charAt(0);if(r.align)return r.alignOffset-(i?1:0);else return(i?r.prev:r).offset},lineComment:"#",fold:"indent"};return n});e.defineMIME("text/x-coffeescript","coffeescript")});