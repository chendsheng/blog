(function(t){if(typeof exports=="object"&&typeof module=="object")t(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],t);else t(CodeMirror)})(function(t){"use strict";t.defineMode("stex",function(){"use strict";function a(t,e){t.cmdState.push(e)}function u(t){if(t.cmdState.length>0){return t.cmdState[t.cmdState.length-1]}else{return null}}function i(t){var e=t.cmdState.pop();if(e){e.closeBracket()}}function c(t){var e=t.cmdState;for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.name=="DEFAULT"){continue}return r}return{styleIdentifier:function(){return null}}}function t(t,e,n){return function(){this.name=t;this.bracketNo=0;this.style=e;this.styles=n;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}var o={};o["importmodule"]=t("importmodule","tag",["string","builtin"]);o["documentclass"]=t("documentclass","tag",["","atom"]);o["usepackage"]=t("usepackage","tag",["atom"]);o["begin"]=t("begin","tag",["atom"]);o["end"]=t("end","tag",["atom"]);o["DEFAULT"]=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};function f(t,e){t.f=e}function s(t,e){var n;if(t.match(/^\\[a-zA-Z@]+/)){var r=t.current().slice(1);n=o[r]||o["DEFAULT"];n=new n;a(e,n);f(e,m);return n.style}if(t.match(/^\\[$&%#{}_]/)){return"tag"}if(t.match(/^\\[,;!\/\\]/)){return"tag"}if(t.match("\\[")){f(e,function(t,e){return l(t,e,"\\]")});return"keyword"}if(t.match("$$")){f(e,function(t,e){return l(t,e,"$$")});return"keyword"}if(t.match("$")){f(e,function(t,e){return l(t,e,"$")});return"keyword"}var i=t.next();if(i=="%"){t.skipToEnd();return"comment"}else if(i=="}"||i=="]"){n=u(e);if(n){n.closeBracket(i);f(e,m)}else{return"error"}return"bracket"}else if(i=="{"||i=="["){n=o["DEFAULT"];n=new n;a(e,n);return"bracket"}else if(/\d/.test(i)){t.eatWhile(/[\w.%]/);return"atom"}else{t.eatWhile(/[\w\-_]/);n=c(e);if(n.name=="begin"){n.argument=t.current()}return n.styleIdentifier()}}function l(t,e,n){if(t.eatSpace()){return null}if(t.match(n)){f(e,s);return"keyword"}if(t.match(/^\\[a-zA-Z@]+/)){return"tag"}if(t.match(/^[a-zA-Z]+/)){return"variable-2"}if(t.match(/^\\[$&%#{}_]/)){return"tag"}if(t.match(/^\\[,;!\/]/)){return"tag"}if(t.match(/^[\^_&]/)){return"tag"}if(t.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(t.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var r=t.next();if(r=="{"||r=="}"||r=="["||r=="]"||r=="("||r==")"){return"bracket"}if(r=="%"){t.skipToEnd();return"comment"}return"error"}function m(t,e){var n=t.peek(),r;if(n=="{"||n=="["){r=u(e);r.openBracket(n);t.eat(n);f(e,s);return"bracket"}if(/[ \t\r]/.test(n)){t.eat(n);return null}f(e,s);i(e);return s(t,e)}return{startState:function(){return{cmdState:[],f:s}},copyState:function(t){return{cmdState:t.cmdState.slice(),f:t.f}},token:function(t,e){return e.f(t,e)},blankLine:function(t){t.f=s;t.cmdState.length=0},lineComment:"%"}});t.defineMIME("text/x-stex","stex");t.defineMIME("text/x-latex","stex")});