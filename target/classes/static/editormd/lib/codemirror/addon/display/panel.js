(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){e.defineExtension("addPanel",function(e,t){if(!this.state.panels)n(this);var i=this.state.panels;if(t&&t.position=="bottom")i.wrapper.appendChild(e);else i.wrapper.insertBefore(e,i.wrapper.firstChild);var r=t&&t.height||e.offsetHeight;this._setSize(null,i.heightLeft-=r);i.panels++;return new s(this,e,t,r)});function s(e,t,i,r){this.cm=e;this.node=t;this.options=i;this.height=r;this.cleared=false}s.prototype.clear=function(){if(this.cleared)return;this.cleared=true;var e=this.cm.state.panels;this.cm._setSize(null,e.heightLeft+=this.height);e.wrapper.removeChild(this.node);if(--e.panels==0)t(this.cm)};s.prototype.changed=function(e){var t=e==null?this.node.offsetHeight:e;var i=this.cm.state.panels;this.cm._setSize(null,i.height+=t-this.height);this.height=t};function n(r){var e=r.getWrapperElement();var t=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;var s=parseInt(t.height);var n=r.state.panels={setHeight:e.style.height,heightLeft:s,panels:0,wrapper:document.createElement("div")};e.parentNode.insertBefore(n.wrapper,e);var i=r.hasFocus();n.wrapper.appendChild(e);if(i)r.focus();r._setSize=r.setSize;if(s!=null)r.setSize=function(e,t){if(t==null)return this._setSize(e,t);n.setHeight=t;if(typeof t!="number"){var i=/^(\d+\.?\d*)px$/.exec(t);if(i){t=Number(i[1])}else{n.wrapper.style.height=t;t=n.wrapper.offsetHeight;n.wrapper.style.height=""}}r._setSize(e,n.heightLeft+=t-s);s=t}}function t(e){var t=e.state.panels;e.state.panels=null;var i=e.getWrapperElement();t.wrapper.parentNode.replaceChild(i,t.wrapper);i.style.height=t.setHeight;e.setSize=e._setSize;e.setSize()}});