(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(u){"use strict";u.defineSimpleMode=function(e,t){u.defineMode(e,function(e){return u.simpleMode(e,t)})};u.simpleMode=function(e,t){p(t,"start");var n={},a=t.meta||{},r=false;for(var o in t)if(o!=a&&t.hasOwnProperty(o)){var i=n[o]=[],l=t[o];for(var s=0;s<l.length;s++){var d=l[s];i.push(new h(d,t));if(d.indent||d.dedent)r=true}}var f={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:r?[]:null}},copyState:function(e){var t={state:e.state,pending:e.pending,local:e.local,localState:null,indent:e.indent&&e.indent.slice(0)};if(e.localState)t.localState=u.copyState(e.local.mode,e.localState);if(e.stack)t.stack=e.stack.slice(0);for(var n=e.persistentStates;n;n=n.next)t.persistentStates={mode:n.mode,spec:n.spec,state:n.state==e.localState?t.localState:u.copyState(n.mode,n.state),next:t.persistentStates};return t},token:g(n,e),innerMode:function(e){return e.local&&{mode:e.local.mode,state:e.localState}},indent:S(n,a)};if(a)for(var c in a)if(a.hasOwnProperty(c))f[c]=a[c];return f};function p(e,t){if(!e.hasOwnProperty(t))throw new Error("Undefined state "+t+"in simple mode")}function s(e,t){if(!e)return/(?:)/;var n="";if(e instanceof RegExp){if(e.ignoreCase)n="i";e=e.source}else{e=String(e)}return new RegExp((t===false?"":"^")+"(?:"+e+")",n)}function n(e){if(!e)return null;if(typeof e=="string")return e.replace(/\./g," ");var t=[];for(var n=0;n<e.length;n++)t.push(e[n]&&e[n].replace(/\./g," "));return t}function h(e,t){if(e.next||e.push)p(t,e.next||e.push);this.regex=s(e.regex);this.token=n(e.token);this.data=e}function g(f,c){return function(e,t){if(t.pending){var n=t.pending.shift();if(t.pending.length==0)t.pending=null;e.pos+=n.text.length;return n.token}if(t.local){if(t.local.end&&e.match(t.local.end)){var a=t.local.endToken||null;t.local=t.localState=null;return a}else{var a=t.local.mode.token(e,t.localState),r;if(t.local.endScan&&(r=t.local.endScan.exec(e.current())))e.pos=e.start+r.index;return a}}var o=f[t.state];for(var i=0;i<o.length;i++){var l=o[i];var s=(!l.data.sol||e.sol())&&e.match(l.regex);if(s){if(l.data.next){t.state=l.data.next}else if(l.data.push){(t.stack||(t.stack=[])).push(t.state);t.state=l.data.push}else if(l.data.pop&&t.stack&&t.stack.length){t.state=t.stack.pop()}if(l.data.mode)v(c,t,l.data.mode,l.token);if(l.data.indent)t.indent.push(e.indentation()+c.indentUnit);if(l.data.dedent)t.indent.pop();if(s.length>2){t.pending=[];for(var d=2;d<s.length;d++)if(s[d])t.pending.push({text:s[d],token:l.token[d-1]});e.backUp(s[0].length-(s[1]?s[1].length:0));return l.token[0]}else if(l.token&&l.token.join){return l.token[0]}else{return l.token}}}e.next();return null}}function d(e,t){if(e===t)return true;if(!e||typeof e!="object"||!t||typeof t!="object")return false;var n=0;for(var a in e)if(e.hasOwnProperty(a)){if(!t.hasOwnProperty(a)||!d(e[a],t[a]))return false;n++}for(var a in t)if(t.hasOwnProperty(a))n--;return n==0}function v(e,t,n,a){var r;if(n.persistent)for(var o=t.persistentStates;o&&!r;o=o.next)if(n.spec?d(n.spec,o.spec):n.mode==o.mode)r=o;var i=r?r.mode:n.mode||u.getMode(e,n.spec);var l=r?r.state:u.startState(i);if(n.persistent&&!r)t.persistentStates={mode:i,spec:n.spec,state:l,next:t.persistentStates};t.localState=l;t.local={mode:i,end:n.end&&s(n.end),endScan:n.end&&n.forceEnd!==false&&s(n.end,false),endToken:a&&a.join?a[a.length-1]:a}}function f(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return true}function S(s,d){return function(e,t,n){if(e.local&&e.local.mode.indent)return e.local.mode.indent(e.localState,t,n);if(e.indent==null||e.local||d.dontIndentStates&&f(e.state,d.dontIndentStates)>-1)return u.Pass;var a=e.indent.length-1,r=s[e.state];e:for(;;){for(var o=0;o<r.length;o++){var i=r[o];if(i.data.dedent&&i.data.dedentIfLineStart!==false){var l=i.regex.exec(t);if(l&&l[0]){a--;if(i.next||i.push)r=s[i.next||i.push];t=t.slice(l[0].length);continue e}}}break}return a<0?0:e.indent[a]}}});