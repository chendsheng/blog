(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(n){"use strict";var t=2;var i="matchhighlight";var r=100;var l=false;function a(e){if(typeof e=="object"){this.minChars=e.minChars;this.style=e.style;this.showToken=e.showToken;this.delay=e.delay;this.wordsOnly=e.wordsOnly}if(this.style==null)this.style=i;if(this.minChars==null)this.minChars=t;if(this.delay==null)this.delay=r;if(this.wordsOnly==null)this.wordsOnly=l;this.overlay=this.timeout=null}n.defineOption("highlightSelectionMatches",false,function(e,t,i){if(i&&i!=n.Init){var r=e.state.matchHighlighter.overlay;if(r)e.removeOverlay(r);clearTimeout(e.state.matchHighlighter.timeout);e.state.matchHighlighter=null;e.off("cursorActivity",o)}if(t){e.state.matchHighlighter=new a(t);s(e);e.on("cursorActivity",o)}});function o(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout);t.timeout=setTimeout(function(){s(e)},t.delay)}function s(h){h.operation(function(){var e=h.state.matchHighlighter;if(e.overlay){h.removeOverlay(e.overlay);e.overlay=null}if(!h.somethingSelected()&&e.showToken){var t=e.showToken===true?/[\w$]/:e.showToken;var i=h.getCursor(),r=h.getLine(i.line),n=i.ch,l=n;while(n&&t.test(r.charAt(n-1)))--n;while(l<r.length&&t.test(r.charAt(l)))++l;if(n<l)h.addOverlay(e.overlay=f(r.slice(n,l),t,e.style));return}var a=h.getCursor("from"),o=h.getCursor("to");if(a.line!=o.line)return;if(e.wordsOnly&&!c(h,a,o))return;var s=h.getRange(a,o).replace(/^\s+|\s+$/g,"");if(s.length>=e.minChars)h.addOverlay(e.overlay=f(s,false,e.style))})}function c(e,t,i){var r=e.getRange(t,i);if(r.match(/^\w+$/)!==null){if(t.ch>0){var n={line:t.line,ch:t.ch-1};var l=e.getRange(n,t);if(l.match(/\W/)===null)return false}if(i.ch<e.getLine(t.line).length){var n={line:i.line,ch:i.ch+1};var l=e.getRange(i,n);if(l.match(/\W/)===null)return false}return true}else return false}function h(e,t){return(!e.start||!t.test(e.string.charAt(e.start-1)))&&(e.pos==e.string.length||!t.test(e.string.charAt(e.pos)))}function f(t,i,r){return{token:function(e){if(e.match(t)&&(!i||h(e,i)))return r;e.next();e.skipTo(t.charAt(0))||e.skipToEnd()}}}});